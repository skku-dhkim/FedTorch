# FedTorch

**FedTorch**는 연구 및 실험을 위한 유연하고 확장 가능한 Federated Learning(연합 학습) 프레임워크입니다. 
이 프로젝트는 PyTorch를 기반으로 구축되었으며, Ray를 활용한 멀티프로세싱 학습을 통해 효율적인 분산 처리를 지원합니다.

## 주요 특징

- **유연한 모델 구성**: 사용자는 다양한 신경망 아키텍처를 손쉽게 정의하고 실험할 수 있습니다.
- **확장 가능한 데이터 파이프라인**: 다양한 데이터셋을 지원하며, 사용자 정의 데이터 로더를 통해 손쉽게 확장 가능합니다.
- **Ray를 활용한 멀티프로세싱 학습**: Ray 라이브러리를 활용하여 멀티프로세싱 환경에서의 효율적인 학습을 지원합니다. 이를 통해 대규모 데이터와 모델을 효과적으로 처리할 수 있습니다.
- **모듈식 설계**: 각 구성 요소가 모듈화되어 있어 필요에 따라 손쉽게 교체하거나 확장할 수 있습니다.

## 설치 방법

이 프로젝트는 Python 3.8 이상에서 동작하며, 다음과 같은 종속성을 필요로 합니다:

- `torch`
- `ray`
- `numpy`
- `pandas`
- `scikit-learn`

필요한 패키지는 다음 명령어를 통해 설치할 수 있습니다:

```bash
pip install -r requirements.txt
```

## 사용 방법

1. **데이터 준비**: `data/` 디렉토리에 학습에 사용할 데이터를 저장합니다.
2. **모델 정의**: `models/` 디렉토리에 새로운 모델 아키텍처를 정의할 수 있습니다.
3. **학습 스크립트 실행**: `run.py` 스크립트를 실행하여 모델 학습을 시작합니다. Ray를 활용한 멀티프로세싱 학습은 스크립트 내에서 자동으로 처리됩니다.

### 필수 파라미터 설명

`run.py`는 연합 학습(Federated Learning)을 실행하는 메인 스크립트로, 다음과 같은 주요 파라미터를 통해 실행할 수 있습니다:

| 파라미터 | 설명 | 예제 |
|----------|------|------|
| `--model` | 사용할 모델 이름 | `cnn`, `resnet`, `lstm` |
| `--dataset` | 사용할 데이터셋 이름 | `mnist`, `cifar10`, `imagenet` |
| `--epochs` | 전체 학습 에폭 수 | `10`, `50`, `100` |
| `--batch_size` | 미니배치 크기 | `32`, `64`, `128` |
| `--lr` | 학습률(Learning Rate) | `0.01`, `0.001`, `0.0001` |
| `--num_clients` | 총 클라이언트 수 | `10`, `50`, `100` |
| `--frac` | 각 라운드에서 참여할 클라이언트의 비율 | `0.1`, `0.5`, `1.0` |
| `--local_ep` | 각 클라이언트에서 수행할 로컬 에폭 수 | `1`, `5`, `10` |
| `--gpu` | 사용할 GPU 사용여부 | `True`, `False`|
| `--gpu_frac` | GPU 메모리 분할 | `0.1`, `0.5` |

### 실행 예시

다음 명령어를 실행하여 연합 학습을 시작할 수 있습니다:

```bash
python run.py --model cnn --dataset mnist --epochs 50 --batch_size 64 --lr 0.01 --num_clients 100 --frac 0.1 --local_ep 5 --gpu True --gpu_frac 0.1
```

위 실행 명령은 다음과 같은 설정을 포함합니다:

- 모델: `cnn`
- 데이터셋: `mnist`
- 전체 에폭 수: `50`
- 배치 크기: `64`
- 학습률: `0.01`
- 총 클라이언트 수: `100`
- 각 라운드에서 참여하는 클라이언트 비율: `10%`
- 각 클라이언트에서 로컬 에폭 수: `5`
- GPU 사용여부: `True`
- GPU 메모리분할: `10%`

이와 같이 파라미터를 조정하여 다양한 실험을 진행할 수 있습니다.


## 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다. 자세한 내용은 `LICENSE` 파일을 참고해 주십시오.

